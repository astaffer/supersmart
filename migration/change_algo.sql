DROP VIEW `sbox`.`int_values`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `int_values` AS (select `base`.`sensor_id` AS `sensor_id`,min(`base`.`int_date`) AS `date_start`,ifnull((select `intdata`.`int_date` from `intdata` where ((`intdata`.`sensor_id` = `base`.`sensor_id`) and (`intdata`.`int_date` > `base`.`int_date`) and (`intdata`.`int_value` <> `base`.`int_value`)) order by `intdata`.`int_date` limit 1),now()) AS `date_end`,`base`.`int_value` AS `int_value` from `intdata` `base` group by `base`.`sensor_id`,`base`.`int_value`,`date_end`);
